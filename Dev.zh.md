# Dev.zh.md: AI辅助开发outline2markdown

本文档概述了 `outline2markdown` 网页工具的快速开发过程。该工具在AI辅助编程（通过Cursor操作Gemini）的大力协助下，约30-60分钟内完成。

## 项目目标

创建一个客户端HTML/CSS/JS网页工具，将多层级大纲（来自文本输入或文件上传）转换为Markdown。主要功能包括：
-   粘贴文本或上传 `.txt`/`.md` 文件。
-   将嵌套列表转换为Markdown的标题和列表。
-   用户可配置的标题层级（手动及自动检测模式）。
-   标题级别整体偏移。
-   将输出复制到剪贴板或下载为 `.md` 文件。
-   现代化、响应式的用户界面（Tailwind CSS, FontAwesome）。
-   国际化（英文/中文），自动检测浏览器语言。
-   支持拖拽上传文件。
-   友情链接至 01mvp.com。

## 开发过程与AI交互（提示与迭代）

开发过程高度迭代，依赖于向Cursor中的AI助手发出提示，以生成、重构和调试代码。

**初始提示（来自用户初次消息的意译）：**
*用户："请帮我创建一个 outline2markdown 网页工具。它需要能处理多层级无序列表并进行转换。请提供一个使用Tailwind CSS、FontAwesome、响应式设计，并通过CDN引入依赖的HTML网站。它应能处理文本输入、文件上传、复制和下载功能。同时提供输入/输出示例，允许用户选择多少层级转为标题，并链接到01mvp.com。"*

**AI响应与第1轮迭代：**
-   AI生成了一个包含HTML结构、Tailwind类、FontAwesome图标（通过CDN）以及初步JavaScript逻辑的 `index.html` 文件，用于实现：
    -   基本的用户界面（文本区域、按钮）。
    -   核心的 `outline2markdown` 函数（处理制表符/空格缩进）。
    -   文件输入、复制和下载功能。
    -   一个用于选择转换为标题的层级数的下拉菜单。
    -   默认的示例文本。
-   同时生成了 `README.md` 文件。

**提示2（优化逻辑与示例）：**
*用户："示例令人困惑。请使用这个更简单的输入/输出。默认从H2到H3，其余为列表项。用户应能选择起始和结束的标题层级。"*

**AI响应与第2轮迭代：**
-   AI更新了 `index.html`：
    -   更改了文本区域中的默认示例。
    -   修改了 `outline2markdown` JS函数，使其接受 `headerStartLevel` 和 `headerEndLevel` 参数。
    -   更新了用户界面，设置了两个下拉菜单分别用于选择起始和结束标题层级。

**提示3（简化控制）：**
*用户："更改设置：1. 转换多少个层级（默认为2）。2. 增加标题偏移选项（+0, +1, +2）。"*

**AI响应与第3轮迭代：**
-   AI重构了 `index.html` 的用户界面：
    -   将起始/结束层级下拉菜单替换为单个"标题层级数"下拉菜单和"标题偏移"下拉菜单。
    -   调整了 `<script>` 标签内的 `outline2markdown` 函数以匹配此新逻辑。

**提示4（代码质量与模块化）：**
*用户："逻辑越来越复杂了。请将转换函数移至一个单独的JS文件，并编写一些单元测试（概念性即可）。"*

**AI响应与第4轮迭代：**
-   AI创建了 `outline-converter.js` 文件。
-   将 `outline2markdown` 及其辅助函数 `getLevel` 移入此新文件。
-   更新了 `index.html` 以包含 `<script src="outline-converter.js"></script>` 并移除了内联函数。
-   在聊天中提供了一系列概念性的单元测试用例以验证逻辑。
-   AI还处理了新JS文件的linter建议（例如，使用 `const` 代替 `let`，使用 `for...of` 代替 `forEach`）。

**提示5（自动检测功能）：**
*用户："为标题层级数添加自动检测模式。例如：如果 `- 3` 下的 `3.1` 没有子内容，则不应转换为 `### 3.1`。请将此模式与手动模式区分开，并添加测试。"*

**AI响应与第5轮迭代：**
-   AI在 `outline-converter.js` 中设计并实现了 `outline2markdownAuto` 函数。
    -   此函数解析大纲，分析L1项目的子项数量，以决定它们应成为标题还是降级为列表项。
-   更新了 `index.html` 的用户界面：
    -   添加了"转换模式"下拉菜单（自动/手动）。
    -   "自动"模式调用 `outline2markdownAuto`；"手动"模式显示"标题层级数"下拉菜单并调用原始的 `outline2markdown`。
-   为新的自动模式提供了概念性单元测试。

**提示6（最终增强 - 当前请求）：**
*用户："1. 国际化（英文/中文，浏览器检测）。2. 解释自动/手动模式的区别。3. 支持拖拽上传文件。4. 创建此Dev.md文档。"*

**AI响应与第6轮迭代（此步骤）：**
-   AI在 `index.html` 中实现了国际化：
    -   向HTML元素添加了 `data-translate-key` 属性。
    -   在JS中为英文和中文字符串创建了 `translations` 对象。
    -   添加了用于浏览器语言检测和手动语言切换的JS代码。
    -   包含了可翻译的UI文本，用以解释自动与手动模式的区别。
-   在 `index.html` 中集成了拖拽文件上传功能。
-   生成了此 `Dev.md` 文档。

## 使用Vercel部署

此项目完全是客户端的（HTML, CSS, JS，无后端构建过程），非常适合像Vercel这样的静态托管平台。

1.  **推送至GitHub：** 将代码库（index.html, outline-converter.js, README.md, Dev.md）推送到GitHub仓库。
2.  **连接到Vercel：**
    -   注册/登录Vercel。
    -   导入GitHub仓库。
    -   Vercel会自动检测其为静态站点。
    -   无需特殊的构建命令或框架预设。
3.  **部署：** 点击"Deploy"。Vercel会托管站点并提供URL，通常在几秒到一分钟内完成。

这种设置可以实现极快的部署和迭代。任何对已连接的GitHub分支的推送都可以触发Vercel上的自动重新部署。

## 总结

通过使用Cursor及其集成的AI，`outline2markdown` 工具得以快速开发完成。该过程涉及清晰、迭代的提示，AI处理了大部分样板代码的生成、根据新需求进行重构，甚至协助调试和提出最佳实践建议。这显著加快了开发进度，使得一个功能丰富的工具能在很短的时间内被创建出来。 